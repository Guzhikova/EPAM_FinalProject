@using DentalOffice.WebUI.Management;
@using DentalOffice.Common;
@using DentalOffice.Entities;
@{
    Layout = "~/Pages/Layouts/_MainLayout.cshtml";

    RolesManagment roleManage = new RolesManagment();
    string message = "";
    string errMessage = "";
    string displayAttr = "style=display:none";

    if (IsPost)
    {
        if (!roleManage.AddRole(Request, out errMessage))
        {
            displayAttr = "";
        }
    }

    var roles = roleManage.GetRoles(out message) ?? new List<Role>();
}

<h4 class="text-center m-2">Управление ролями</h4>

<div class="row">
    <div class="col-md-4">

        <table class="table">
            <tbody>
                @foreach (var role in roles)
                {
                    <tr>
                        <td>
                            <a href="~/Pages/Admin/Confirmation?action=delete&entity=role&id=@role.ID" title="Удалить">
                                <img class="w-25" src="~/Content/images/delete.svg">
                            </a>
                        </td>
                        <text>&#8195;</text>
                        <td><a data-ajax="true" data-ajax-mode="replace" data-ajax-update="#usersForRole" href="~/Pages/ajax?action=usersForRole&roleId=@role.ID">@role.Title</a></td>
                    </tr>
                }

            </tbody>
        </table>



    </div>
    <div class="col-md-8" id="usersForRole">

    </div>
    <form class="form-inline ml-4" action="~/Pages/Admin/RoleManagement" method="post">
        <div class="form-group">
            <input type="text" class="form-control" name="title" placeholder="Название">
        </div>
        <button type="submit" class="btn btn-success m-lg-2">Создать роль</button>
    </form>
    <div class="alert alert-danger ml-4" role="alert" @displayAttr>
       <strong>Ошибка:</strong> @errMessage
    </div>
</div>